# Feed Finder 改良版 - 要件仕様書

## はじめに

サイトの URL をフォーム経由で入力すると、そのサイトの RSS/Atom フィードを自動検索し、発見されたフィードをリンク付きで表示する Web アプリケーションです。フィードが見つからない場合は、その旨を明確に表示します。

## 要件の優先度

### 第一優先度（必須実装）

要件 1〜8 は必須実装項目です。これらの要件を満たすことで、基本的なフィード検索機能が完成します。

### 第二優先度（オプション機能）

要件 9〜11 はオプション機能です。基本機能の実装完了後に、必要に応じて実装を検討します。実装するかどうかは今後の判断に委ねられます。

## 要件

### 要件 1: フィード検索機能

**ユーザーストーリー:** サイト管理者として、任意の Web サイトの RSS/Atom フィードを簡単に発見したい。そうすることで、フィードリーダーに登録したり、他のサービスと連携したりできる。

#### 受入基準

1. WHEN ユーザーが URL を入力して検索ボタンを押す THEN システムはそのサイトの RSS/Atom フィードを自動検索する
2. WHEN フィードが発見される THEN システムはフィードの URL、タイトル、種別（RSS/Atom）を表示する
3. WHEN 複数のフィードが発見される THEN システムはすべてのフィードを一覧表示する
4. WHEN フィードが発見されない THEN システムは「フィードが見つかりませんでした」と明確に表示する

### 要件 2: 多段階検索戦略

**ユーザーストーリー:** 開発者として、可能な限り多くのフィードを発見したい。そうすることで、ユーザーの満足度を高められる。

#### 受入基準

1. WHEN HTML メタタグにフィード情報がある THEN システムは RSS Autodiscovery 標準に従ってフィードを検出する
2. WHEN HTML メタタグでフィードが見つからない THEN システムは一般的なフィードパス（/feed、/rss.xml 等）を確認する
3. WHEN 両方の方法でフィードを発見する THEN システムは重複を除去して表示する
4. WHEN 検索方法を記録する THEN システムは各フィードがどの方法で発見されたかを表示する

### 要件 3: URL 正規化とエラーハンドリング

**ユーザーストーリー:** 一般ユーザーとして、URL の入力形式を気にせずに検索したい。そうすることで、使いやすいツールとして活用できる。

#### 受入基準

1. WHEN プロトコルなしの URL（example.com）を入力する THEN システムは自動的に https://を追加する
2. WHEN http://の URL を入力する THEN システムは自動的に https://に変換する
3. WHEN 無効な URL 形式を入力する THEN システムは分かりやすいエラーメッセージを表示する
4. WHEN ネットワークエラーが発生する THEN システムは適切なエラーメッセージを表示する

### 要件 4: ユーザーインターフェース

**ユーザーストーリー:** 一般ユーザーとして、直感的で使いやすいインターフェースでフィード検索を行いたい。そうすることで、技術的な知識がなくても簡単に利用できる。

#### 受入基準

1. WHEN メインページにアクセスする THEN システムはシンプルな URL 入力フォームを表示する
2. WHEN 検索結果が表示される THEN システムは各フィードに対して「開く」と「URL コピー」ボタンを提供する
3. WHEN フィード URL をコピーする THEN システムはクリップボードに URL をコピーする
4. WHEN フィードを開く THEN システムは新しいタブでフィードを表示する
5. WHEN モバイルデバイスでアクセスする THEN システムはレスポンシブデザインで適切に表示する

### 要件 5: パフォーマンスとセキュリティ

**ユーザーストーリー:** システム管理者として、高速で安全なアプリケーションを提供したい。そうすることで、ユーザーに信頼性の高いサービスを提供できる。

#### 受入基準

1. WHEN フィードの存在確認を行う THEN システムは HEAD リクエストを使用して効率的に確認する
2. WHEN ユーザー入力を表示する THEN システムは XSS 攻撃を防ぐために HTML エスケープを行う
3. WHEN 外部リソースを読み込む THEN システムは SRI（Subresource Integrity）を使用して整合性を確認する
4. WHEN 検索処理を実行する THEN システムは 5 秒以内にレスポンスを返す

### 要件 6: 国際化対応

**ユーザーストーリー:** 日本のユーザーとして、日本語で操作できるインターフェースを使いたい。また、海外のユーザーとして、英語でも利用できるようにしたい。そうすることで、より多くのユーザーに使いやすいツールを提供できる。

#### 受入基準

1. WHEN アプリケーションにアクセスする THEN システムはデフォルトで日本語のユーザーインターフェースを表示する
2. WHEN 言語切り替えボタンをクリックする THEN システムは英語のユーザーインターフェースに切り替える
3. WHEN エラーが発生する THEN システムは選択された言語でエラーメッセージを表示する
4. WHEN 検索結果を表示する THEN システムは選択された言語で説明文を表示する
5. WHEN 言語設定を変更する THEN システムはブラウザのローカルストレージに設定を保存する

### 要件 7: CI/CD 自動化

**ユーザーストーリー:** 開発者として、コードの品質と安全性を保ちながら効率的にデプロイしたい。そうすることで、手動作業によるミスを防ぎ、継続的な改善を実現できる。

#### 受入基準

1. WHEN コードを push する THEN 自動的に lint、フォーマット、型チェックが実行される
2. WHEN プルリクエストを作成する THEN 自動的にテストスイートが実行される
3. WHEN main ブランチにマージする THEN 自動的に本番環境にデプロイされる
4. WHEN デプロイが失敗する THEN システムは前のバージョンに自動的にロールバックする
5. WHEN セキュリティ脆弱性が検出される THEN システムは自動的にアラートを送信する

### 要件 8: アクセシビリティ

**ユーザーストーリー:** 視覚障害や運動障害のあるユーザーとして、スクリーンリーダーやキーボード操作でアプリケーションを利用したい。そうすることで、誰でも平等にフィード検索機能を活用できる。

#### 受入基準

1. WHEN スクリーンリーダーを使用する THEN システムは適切な ARIA ラベルとセマンティック HTML を提供する
2. WHEN キーボードのみで操作する THEN システムはすべての機能にキーボードでアクセスできる
3. WHEN フォーカスを移動する THEN システムは視覚的にフォーカス状態を明確に表示する
4. WHEN 色覚異常のユーザーがアクセスする THEN システムは色だけに依存しない情報表示を行う

### 要件 9: 検索履歴とお気に入り

**ユーザーストーリー:** 頻繁にフィード検索を行うユーザーとして、過去に検索した URL や見つけたフィードを簡単に再利用したい。そうすることで、作業効率を向上させることができる。

#### 受入基準

1. WHEN URL を検索する THEN システムは検索履歴をローカルストレージに保存する
2. WHEN 検索フォームをクリックする THEN システムは過去の検索履歴を候補として表示する
3. WHEN フィードを発見する THEN システムは「お気に入りに追加」ボタンを表示する
4. WHEN お気に入りに追加する THEN システムはフィード情報をローカルストレージに保存する
5. WHEN お気に入り一覧を表示する THEN システムは保存されたフィードを一覧表示する

### 要件 10: バッチ検索機能

**ユーザーストーリー:** 複数のサイトのフィードを一度に調べたいユーザーとして、複数の URL を一括で検索したい。そうすることで、大量のサイトのフィード情報を効率的に収集できる。

#### 受入基準

1. WHEN 複数 URL モードを選択する THEN システムはテキストエリアで複数の URL 入力を受け付ける
2. WHEN 複数の URL を入力する THEN システムは改行区切りまたはカンマ区切りで URL を解析する
3. WHEN バッチ検索を実行する THEN システムは各 URL を順次検索して結果を表示する
4. WHEN バッチ検索中にエラーが発生する THEN システムは該当 URL のエラーを表示し、他の URL の検索を継続する
5. WHEN バッチ検索が完了する THEN システムは結果を CSV または JSON 形式でエクスポートできる

### 要件 11: フィード詳細情報

**ユーザーストーリー:** フィードの詳細を知りたいユーザーとして、フィードの最新記事や更新頻度などの情報を確認したい。そうすることで、フィードの品質や活動状況を判断できる。

#### 受入基準

1. WHEN フィードの詳細ボタンをクリックする THEN システムはフィードの内容を解析して詳細情報を表示する
2. WHEN フィード詳細を表示する THEN システムは最新記事のタイトルと日付を表示する
3. WHEN フィード詳細を表示する THEN システムは推定される更新頻度を表示する
4. WHEN フィード詳細を表示する THEN システムはフィードの説明文を表示する
