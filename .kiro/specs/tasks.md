# Feed Finder 改良版 - 実装タスクリスト

## 実装計画概要

この実装計画は、要件仕様書と設計仕様書に基づいて、Feed Finder 改良版を段階的に実装するためのタスクリストです。各タスクは独立して実行可能で、**t-wada 式 TDD（Red-Green-Refactor サイクル）を厳格に適用**し、段階的に機能を構築していきます。

## TDD 実装原則

### 必須遵守事項

1. **Red フェーズ**: 必ず失敗するテストを最初に作成
2. **Green フェーズ**: テストを通すための最小限の実装のみ
3. **Refactor フェーズ**: テストを変更せずに実装コードを改善
4. **小さなステップ**: 一度に一つの機能のみ実装
5. **継続的実行**: 各ステップでテストを実行して確認

## タスクリスト

- [x] 1. プロジェクト基盤セットアップ

  - React 19 + Vite + TypeScript 環境の構築
  - shadcn/ui + TailwindCSS v4 の導入
  - TailwindCSS v4 記法の採用（v3 以前の記法は使用禁止）
  - Cloudflare Workers 環境の更新
  - node-html-parser の導入（HTML パーシング用）
  - neverthrow の導入（エラーハンドリング用）
  - Node.js 20.19.4+ 対応
  - 基本的なビルド・デプロイパイプラインの確立
  - _要件: 要件 5（パフォーマンスとセキュリティ）_

- [x] 2. 型定義とコア関数の実装

  - [x] 2.1 基本型定義の作成

    - FeedResult、SearchResult、FeedSearchError 型の定義
    - 国際化関連の型定義（Language、Messages）
    - React コンポーネントの Props 型定義
    - _要件: 要件 1（フィード検索機能）、要件 6（国際化対応）_

  - [x] 2.2 URL 正規化関数の TDD 実装

    - **Red**: プロトコル未指定 URL のテスト作成（失敗確認）
    - **Green**: 最小限の実装でテスト通過
    - **Refactor**: コードの改善とエラーハンドリング追加
    - **Red**: http→https 変換のテスト作成
    - **Green**: 変換機能の最小実装
    - **Refactor**: URL 検証機能の追加
    - _要件: 要件 3（URL 正規化とエラーハンドリング）、要件 8（TDD）_

  - [x] 2.3 HTML エスケープ関数の TDD 実装
    - **Red**: 基本的な HTML エスケープのテスト作成
    - **Green**: 最小限のエスケープ機能実装
    - **Refactor**: 全ての危険文字への対応
    - **Red**: XSS 攻撃パターンのテスト追加
    - **Green**: セキュリティ強化の実装
    - _要件: 要件 5（パフォーマンスとセキュリティ）、要件 8（TDD）_

- [x] 3. フィード検索エンジンの実装

  - [x] 3.1 HTML メタタグ解析機能

    - extractFeedLinksFromHtml 関数の実装
    - RSS Autodiscovery 標準準拠の実装
    - 相対 URL→ 絶対 URL 変換機能
    - フィード種別判定（RSS/Atom）
    - _要件: 要件 2（多段階検索戦略）_

  - [x] 3.2 フィード存在確認機能

    - checkFeedExists 関数の実装
    - HEAD リクエストによる効率的確認
    - ネットワークエラーハンドリング
    - _要件: 要件 2（多段階検索戦略）、要件 5（パフォーマンスとセキュリティ）_

  - [x] 3.3 一般的パス検索機能

    - findCommonPathFeeds 関数の実装
    - 一般的なフィードパスの定義
    - 並列処理による効率化
    - _要件: 要件 2（多段階検索戦略）_

  - [x] 3.4 メイン検索関数の実装
    - searchFeeds 関数の実装
    - 段階的検索戦略の実装
    - ResultAsync 型による非同期エラーハンドリング
    - 重複フィード除去機能
    - _要件: 要件 1（フィード検索機能）、要件 2（多段階検索戦略）_

- [ ] 4. 国際化システムの実装

  - [ ] 4.1 サーバーサイド国際化

    - 言語検出機能（Accept-Language ヘッダー）
    - サーバーサイドメッセージ管理
    - 初期 HTML 生成時の言語設定
    - _要件: 要件 6（国際化対応）_

  - [ ] 4.2 クライアントサイド国際化
    - React Context による言語状態管理
    - ローカルストレージによる言語設定保存
    - 動的言語切り替え機能
    - 翻訳メッセージの管理システム
    - _要件: 要件 6（国際化対応）_

- [ ] 5. React コンポーネントの実装

  - [x] 5.1 基本 UI コンポーネント

    - shadcn/ui コンポーネントのセットアップ
    - Button、Input、Card、Alert コンポーネントの導入
    - TailwindCSS v4 記法によるスタイリング（v3 以前の記法は使用しない）
    - _要件: 要件 4（ユーザーインターフェース）_

  - [x] 5.2 検索フォームコンポーネント

    - SearchForm コンポーネントの実装
    - URL 入力バリデーション
    - 送信処理とローディング状態
    - アクセシビリティ対応（ARIA、キーボードナビゲーション）
    - _要件: 要件 4（ユーザーインターフェース）、要件 8（アクセシビリティ）_

  - [x] 5.3 結果表示コンポーネント

    - ResultDisplay コンポーネントの実装
    - FeedCard コンポーネントの実装
    - エラー表示コンポーネント
    - 成功・警告アラートの実装
    - _要件: 要件 4（ユーザーインターフェース）_

  - [ ] 5.4 言語切り替えコンポーネント
    - LanguageToggle コンポーネントの実装
    - 言語状態の管理
    - 視覚的フィードバック
    - _要件: 要件 6（国際化対応）_

- [ ] 6. ローカルストレージ機能の実装

  - [ ] 6.1 検索履歴機能

    - 検索履歴の保存・読み込み
    - 履歴の表示と選択機能
    - 履歴のクリア機能
    - _要件: 要件 10（検索履歴とお気に入り）_

  - [ ] 6.2 お気に入り機能
    - フィード情報の保存・読み込み
    - お気に入り一覧の表示
    - お気に入りの削除機能
    - _要件: 要件 10（検索履歴とお気に入り）_

- [x] 7. API エンドポイントの実装

  - [x] 7.1 検索 API エンドポイント

    - POST /api/search エンドポイントの実装
    - JSON API レスポンスの実装
    - エラーレスポンスの標準化
    - _要件: 要件 1（フィード検索機能）_

  - [ ] 7.2 SSR ページエンドポイント
    - GET / メインページの実装
    - React SSR の実装
    - 初期言語設定の処理
    - _要件: 要件 4（ユーザーインターフェース）、要件 6（国際化対応）_

- [ ] 8. アクセシビリティ対応の実装

  - [ ] 8.1 WCAG 2.2 基本対応

    - セマンティック HTML の実装
    - ARIA ラベルの適切な設定
    - キーボードナビゲーションの実装
    - フォーカス管理（Focus Not Obscured 対応）
    - _要件: 要件 9（アクセシビリティ）_

  - [ ] 8.2 タッチアクセシビリティ対応
    - タッチターゲットサイズの最適化（24×24px 以上）
    - モバイルデバイスでの操作性向上
    - TailwindCSS v4 記法によるレスポンシブデザインの実装
    - _要件: 要件 9（アクセシビリティ）_

- [ ] 9. パフォーマンス最適化

  - [ ] 9.1 非同期処理の最適化

    - Promise.all()による並列処理の実装
    - ResultAsync 合成の最適化
    - 不要な HTTP リクエストの削減
    - _要件: 要件 5（パフォーマンスとセキュリティ）_

  - [ ] 9.2 バンドル最適化
    - 未使用コードの削除
    - コード分割の実装
    - 静的リソースの最適化
    - _要件: 要件 5（パフォーマンスとセキュリティ）_

- [x] 10. テストの実装

  - [x] 10.1 単体テストの実装

    - URL 正規化関数のテスト
    - HTML エスケープ関数のテスト
    - フィード検索関数のテスト
    - 国際化関数のテスト
    - _要件: 全要件の品質保証_

  - [ ] 10.2 コンポーネントテストの実装
    - React コンポーネントのテスト
    - ユーザーインタラクションのテスト
    - アクセシビリティテスト
    - _要件: 要件 4（ユーザーインターフェース）、要件 9（アクセシビリティ）_

- [x] 11. CI/CD パイプラインの実装

  - [x] 11.1 Git フック（lefthook）の設定強化

    - TypeScript 型チェックの追加（tsc --noEmit）
    - 依存関係脆弱性チェックの追加（security-audit: npm audit --audit-level moderate）
    - pre-commit と pre-push の分離による高速化（pre-push: 0.41 秒に最適化）
    - src フォルダのみに対象を絞り込み、開発者体験を向上
    - _要件: 要件 7（CI/CD 自動化）_

  - [x] 11.2 GitHub Actions ワークフローの設定

    - .github/workflows/ci.yml の作成
    - Biome による lint・フォーマット・型チェックの自動実行
    - プルリクエスト時の自動テスト実行
    - セキュリティ監査の統合
    - _要件: 要件 7（CI/CD 自動化）_

  - [x] 11.3 デプロイメントワークフローの設定

    - 手動デプロイ手順の文書化
    - **変更点**: 自動デプロイは無効化し、手動デプロイを推奨
    - **理由**: セキュリティとコントロールのため
    - _要件: 要件 7（CI/CD 自動化）_

  - [x] 11.4 セキュリティスキャンの設定
    - .github/workflows/security.yml の作成
    - 依存関係の脆弱性スキャン（npm audit + dependency-review）
    - CodeQL による静的解析
    - 週次スケジュール実行の設定
    - セキュリティ結果のアーティファクト保存
    - _要件: 要件 7（CI/CD 自動化）_

- [ ] 12. 統合とデプロイ

  - [ ] 12.1 統合テスト

    - エンドツーエンドテストの実装
    - API 統合テスト
    - ブラウザ互換性テスト
    - _要件: 全要件の統合確認_

  - [ ] 12.2 本番デプロイ
    - Cloudflare Workers へのデプロイ
    - カスタムドメインの設定
    - 監視とログ設定
    - _要件: 要件 5（パフォーマンスとセキュリティ）_

## オプション機能（第二優先度）

- [ ] 13. バッチ検索機能の実装

  - 複数 URL 入力インターフェース
  - バッチ処理エンジン
  - 結果エクスポート機能
  - _要件: 要件 11（バッチ検索機能）_

- [ ] 14. フィード詳細情報機能
  - フィード内容解析
  - 最新記事表示
  - 更新頻度推定
  - _要件: 要件 12（フィード詳細情報）_
